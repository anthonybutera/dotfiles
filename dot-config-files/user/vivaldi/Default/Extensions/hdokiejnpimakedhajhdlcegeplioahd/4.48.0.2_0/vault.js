LPVault={};var initialize=function(a,s,i){var n=Strings.translateString("Folder (a-z)"),o=Strings.translateString("Folder (z-a)"),r=Strings.translateString("Name (a-z)"),l=Strings.translateString("Name (z-a)"),c=Strings.translateString("Most Recent"),d=Strings.translateString("Sender (a-z)"),u=Strings.translateString("Sender (z-a)"),p=Strings.translateString("Recipient (a-z)"),g=Strings.translateString("Recipient (z-a)"),e=[n,o,r,l,c],t=[r,l],m=[r,l,p,g,c],f=[r,l,d,u,c],h=[r,l],y=[r,l],v=function(e){this.options=e};v.prototype.getAddElement=function(){return void 0===this.addElement&&(this.addElement=LPTools.createElement("div","addMenuItem"),this.build(this.addElement,this.options.icon?this.options.icon:"images/vault_4.0/Add.png")),this.addElement},v.prototype.build=function(e,t){var n=this.options.autoId||"";e.appendChild(LPTools.createElement("span",null,Strings.Vault[this.options.text])).setAttribute("automation-id",n);var o=LPTools.createElement("div"),i=LPTools.createElement("div"),a=LPTools.createElement("img",{src:t});e.appendChild(o),o.appendChild(i),i.appendChild(a),$(e).bind("click",this.options.func)},v.prototype.getMenuElement=function(){return void 0===this.menuElement&&(this.menuElement=LPTools.createElement("li","addMenuItem"),this.build(this.menuElement,this.options.additionalIcon)),this.menuElement};var P={Site:new v({text:"ADD_SITE",autoId:"vaultAddSiteButton",icon:"images/vault_4.0/Sites_Active.png",func:function(){s.openSiteDialog({saveOptions:{source:"vault"}})}}),Note:new v({text:"ADD_NOTE",autoId:"vaultAddNoteButton",icon:"images/vault_4.0/Notes_Active.png",additionalIcon:"images/vault_4.0/Add_Secure_Note.png",func:function(){s.openNoteDialog({saveOptions:{source:"vault"}})}}),FormFill:new v({text:"ADD_FORM_FILL",autoId:"vaultAddFormFillButton",icon:"images/vault_4.0/Form_Fills_Active.png",func:function(){s.openFormFillDialog({saveOptions:{source:"vault"}})}}),SharedFolder:new v({text:"ADD_SHARED_FOLDER",autoId:"vaultAddSharedFolderButton",func:function(){s.openCreateSharedFolderDialog()}}),Identity:new v({text:"ADD_IDENTITY",autoId:"vaultAddIdentityButton",func:function(){s.openIdentityDialog()}}),EmergencyAccess:new v({text:"GIVE_EMER_ACCESS",autoId:"vaultGiveEmerAccessButton",func:function(){LPProxy.getUser().isFreeOrTrial()&&LPFeatures.restrictEmergencyAccessForFree()||LPProxy.isExpiredFamilyUser()?(bg.sendLpImprove("restricted_emergency_access_lightbox_shown"),dialogs.restrictedEmergencyAccess.open()):dialogs.addEmergencyAccess.open()}}),CreditMonitoring:new v({text:"ADD_CREDIT_MON",autoId:"vaultAddCreditButton",func:function(){s.openCreateCreditMonitoringDialog()}}),Folder:new v({text:"ADD_FOLDER",autoId:"vaultAddNewFolderButton",additionalIcon:"images/vault_4.0/Add_Folder.png",func:function(){s.openFolderDialog()}}),ShareItems:new v({text:"SHARE_ITEMS",autoId:"vaultAddShareItemsButton",additionalIcon:"images/vault_4.0/Add_Share.png",func:function(){s.openShareDialog()}})},L=Strings.translateString("search my vault"),b=null,S=$("#advacedOptionsOverlay"),E=$("#inProgressOverlay"),I=$("#tools"),_=$("#options"),T=$("#mainScroll"),C=$("#addMenu"),A=$("#addMenuItems"),D=$("#addMenuButton"),w=$("#addMenuButtonCustom"),M=$("#gridButton"),F=$("#listButton"),k=$("#collapseAllToggle"),x=$("#sizeToggle"),O=$("#orderOption"),B=$("#sortOrderMenu"),R=$("#sortOrderOption"),N=$("#userMenuItems"),U=$("#leftMenuMinimizeButton"),G=$("#moreActions"),z=a.getElementById("contextMenu").parentElement,V=$(a.body),H=$("#advancedMenuItem"),W=a.getElementById("sortOrderMenu").children[0],Y=$("#vaultSearch"),j=$("#userMenuContainer"),q=$("#pageTitle"),X=$("#cloudAppsMenuItem"),K=$(".securityMenuItem"),Q=$(".securityDashboardMenuItem"),Z=null,J=null,ee=!0,te=null,ne=null,oe=null,ie=function(e,t){oe.getContainer()===t&&(oe.removeBodyState(),oe.addBodyState())},ae=function(e){var n;e=e||{},this.state=e.bodyState,this.menuElement=e.menuElement||null,this.emptyState=this.state+"Empty",this.container=null,this.sortOptions=e.sortOptions||null,this.persistent=LPTools.getOption(e,"persistent",!0),this.searchPlaceholder=LPTools.getOption(e,"searchPlaceholder",L),this.title=e.title||"",this.addMenu=e.addMenu,this.additionalOptionButtons=e.additionalOptionButtons,this.scrollParent=e.scrollParent,this.notificationCount=e.notificationCount,n=this,Topics.get(Topics.CLEAR_DATA).subscribe(function(){n.clear()}),e.menuElement&&e.menuElement.unbind("click.menu").bind("click.menu",function(){var e=void 0;try{var t=LPProxy.getConfigViewObject(n.getElement().id);void 0!==t.segmentEvent&&bg.sendLpImprove(t.segmentEvent),e=t.url}catch(e){}void 0!==e?bg.openOnNewTab(e):n.parent?n.parent.show(n):n.show()})};ae.prototype.getElement=function(){return this.menuElement.get(0)},ae.prototype.applyContainerFunction=function(e){var t=this.getContainer();if(null!==t)switch(typeof e){case"string":var n=[];if(1<arguments.length)for(var o=1,i=arguments.length;o<i;++o)n.push(arguments[o]);return t[e].apply(t,n);case"function":return e(t)}},ae.prototype.updateNotificationCount=function(e){var t=0,n=this.menuElement.find(".tabNotification");return void 0!==e?(t=parseInt(n.text()),it(n,t-e),this.parent&&this.parent.updateNotificationCount(e)):this.notificationCount&&(t=this.notificationCount(),it(n,t)),t},ae.prototype.getSortOptions=function(){return this.sortOptions},ae.prototype.getContainer=function(){return this.container},ae.prototype.setContainer=function(e,t){(this.container=e)&&(e._buildOptions.stateChangeCallback=ie,LPTools.getOption(t,"checkForStateChange",!0)&&oe===this&&ie(e.isEmpty(),e),oe===this&&""!==Y.val()&&s.search(Y.val()))},ae.prototype.openAll=function(){this.applyContainerFunction("openAll")},ae.prototype.collapseAll=function(){this.applyContainerFunction("collapseAll")},ae.prototype.createSelectionContextMenu=function(){return this.applyContainerFunction("createSelectionContextMenu")},ae.prototype.isEmpty=function(){return this.applyContainerFunction("isEmpty")},ae.prototype.search=function(e){var t=this.applyContainerFunction("applySearch",e);e&&null===t&&!this.isEmpty()?V.addClass("searchEmpty"):V.removeClass("searchEmpty")},ae.prototype.clearSelected=function(){this.applyContainerFunction("clearSelected")},ae.prototype.getSelectedItems=function(){return this.applyContainerFunction("getSelectedItems")},ae.prototype.getSortOrder=function(){if(void 0===this.sortOrder){var e=this.sortOptions?this.sortOptions[0]:null;this.sortOrder=LPProxy.getPreference(this.state+"SortOrder",e)}return this.sortOrder},ae.prototype.setSortOrder=function(e){this.sortOrder=e,LPProxy.setPreferences(this.state+"SortOrder",e)},ae.prototype.addBodyState=function(){V.addClass(this.getState());var e=this.getContainer();null!==e&&e.isEmpty()?V.addClass("empty"):V.removeClass("empty"),setTimeout(function(){Topics.get(Topics.EMPTY_VAULT_STATE_CHANGE).publish()},400)},ae.prototype.removeBodyState=function(){V.removeClass(this.emptyState),V.removeClass(this.state)},ae.prototype.hide=function(){if(null!==this.menuElement&&this.menuElement.removeClass("selected"),this.parent&&null!==this.parent.menuElement&&this.parent.menuElement.removeClass("selected"),this.removeBodyState(),this.additionalOptionButtons)for(var e=0,t=this.additionalOptionButtons.length;e<t;++e)this.additionalOptionButtons[e].detach();this.persistent?this.applyContainerFunction("hide"):this.clear()},ae.prototype.getAddMenuItems=function(){var e=[];if(this.addMenu&&0<this.addMenu.length)for(var t=0,n=this.addMenu.length;t<n;++t){var o=this.addMenu[t];o===P.ShareItems&&!LPFeatures.allowIndividualSharing()||o===P.Note&&!LPFeatures.allowNotes()||e.push(o)}return e},ae.prototype.show=function(){if(oe!==this){null!==oe&&(xe(),oe.hide()),Y.attr("placeholder",this.searchPlaceholder),null!==this.menuElement&&this.menuElement.addClass("selected"),this.parent&&null!==this.parent.menuElement&&this.parent.menuElement.addClass("selected"),q.text(this.title),this.addBodyState(),this.scrollParent.scrollTop(0);var e=this.getSortOptions();null!==oe&&oe.getSortOptions()===e||Be(e);var t=(oe=this).getSortOrder();t&&s.sort(t),this.additionalOptionButtons&&_.append(this.additionalOptionButtons),A.children().detach(),w.children().detach();var n=this.getAddMenuItems();if(0<n.length){var o=n[0];w.append(o.getAddElement());for(var i=n.length-1;0<i;--i)A.append(n[i].getMenuElement());D.show()}else D.hide();LPProxy.getPreference("leftMenuMaximize")?s.maximizeLeftMenu():s.minimizeLeftMenu()}},ae.prototype.getState=function(){return this.isEmpty()?this.emptyState:this.state},ae.prototype.clear=function(){this.container&&(this.container.destruct(),this.container=null)};var re=function(e){var o;e.bodyState=e.bodyState||e.contentID,ae.call(this,e),this.contentElement=a.getElementById(e.contentID),this.containerType=e.containerType,this.dataSource=e.dataFunction,this.buildOptions=e.buildOptions,this.filter=e.filter,o=this,Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){o.refresh(e)}),o.initializeCallback=function(e,t){var n=new o.containerType(e,o.buildOptions);n.initialize(o.contentElement,o.scrollParent),o.filter&&n.applyFilter(o.filter,{checkForStateChange:!1}),o.setContainer(n,{checkForStateChange:LPTools.getOption(t,"checkForStateChange",!1)}),Topics.get(Topics.DIALOG_LOADED).publish()}};((re.prototype=Object.create(ae.prototype)).constructor=re).prototype.makeDataRequest=function(e,t){t.error=function(){Topics.get(Topics.DIALOG_LOADED).publish()},LPRequest.makeDataRequest(e,t)},re.prototype.initialize=function(e,t){var n,o;null===this.container&&null!==this.containerType&&null!==this.dataSource&&(n=this,e=(o=e)?function(e,t){n.initializeCallback(e,t),o()}:n.initializeCallback,Topics.get(Topics.DIALOG_LOADING).publish(),this.dataSource.call(this,e,t))},re.prototype.show=function(e){var t;null===this.container?(t=this).initialize(function(){e&&e(),ae.prototype.show.apply(t)}):(ae.prototype.show.apply(this),e&&e())},re.prototype.refresh=function(e){null!==this.container&&(this.container.destruct(),this.container=null,this.initialize(null,{identity:e,checkForStateChange:!0}))};var se=function(e){ae.call(this,e),this.setContainer(e.container||null),this.filter=e.filter};((se.prototype=Object.create(ae.prototype)).constructor=se).prototype.show=function(){this.container.applyFilter(this.filter,{checkForStateChange:!1}),ae.prototype.show.apply(this,arguments)};var le=function(o){var n=null,e;if(o.views&&0<o.views.length){for(var t=0,i=o.views.length;t<i;++t)o.views[t].parent=this;this.show=function(e,t){e?(e.show(t),n=e):(null===n&&(n=o.defaultView()),n.show(t))},this.clear=function(){n=null},this.menuElement=o.menuElement;var a=o.menuElement.find(".notificationBubble");this.updateNotificationCount=function(e){for(var t=0,n=a.length;t<n;++t){var o=$(a[t]);it(o,parseInt(o.text())-e)}};var r=function(){for(var e=0,t=0,n=o.views.length;t<n;++t)e+=o.views[t].updateNotificationCount();it(a,e)};Topics.get(Topics.LOGIN).subscribe(r),Topics.get(Topics.REFRESH_DATA).subscribe(r),e=this,Topics.get(Topics.CLEAR_DATA).subscribe(function(){e.clear()})}},ce=new re({containerType:IdentityContainer,dataFunction:function(e){for(var t=[],n=0,o=b._identities.length;n<o;++n)t.push(b._identities[n].newDisplayObject());e(t)},sortOptions:y,contentID:"identityContent",bodyState:"identity",scrollParent:T,searchPlaceholder:Strings.translateString("search my identities"),buildOptions:{multiSelect:!1},title:Strings.translateString("Identities"),addMenu:[P.Identity]}),de=new re({containerType:CreditMonitoringContainer,dataFunction:(ue=function(e,t,n){for(var o=!0,i=[],a=0,r=t.length;a<r;++a){var s=t[a];"1"!==s.premium&&(o=!1),i.push(new CreditMonitoringProfile(s))}var l=$("#creditMonitoring .viewExplanation");o?(l.hide(),de.title=Strings.translateString("Premium Credit Monitoring")):(l.show(),de.title=Strings.translateString("Credit Monitoring")),e(i,n)},function(t,n){this.makeDataRequest(LPProxy.getCreditMonitoringData,{success:function(e){ue(t,e,n)}})}),persistent:!1,contentID:"creditMonitoring",scrollParent:T,title:Strings.translateString("Credit Monitoring"),addMenu:[P.CreditMonitoring]}),ue,pe=new re({containerType:GridListContainer,dataFunction:function(e,t){this.makeDataRequest(LPProxy.getDeletedItems,{success:e})},filter:{showEmptyGroups:!1},sortOptions:e,contentID:"deletedItems",scrollParent:T,persistent:!1,searchPlaceholder:Strings.translateString("search my deleted items"),buildOptions:{allowDrag:!1,stickyFolders:!0,stickyFolderParent:a.getElementById("main")},title:Strings.translateString("Deleted Items"),additionalOptionButtons:[(ge=LPTools.createElement("div",{class:"optionButton optionButtons",id:"purgeAllButton"},Strings.Vault.PURGE_ALL),LPPlatform.addEventListener(ge,"click",function(){var e=pe.getContainer();if(e){var t=e.getItemModelChildren();0<t.length&&t[0].purge({itemsForAction:t})}}),$(ge))]}),ge;pe.refresh=function(){};var me=new re({containerType:EmergencyAccessRecipientContainer,dataFunction:function(e,t){this.makeDataRequest(LPProxy.getEmergencyAccessRecipientInfo,{success:e})},filter:{showEmptyGroups:!1},sortOptions:e,menuElement:$("#emergencyTrustedMenuItem"),contentID:"emergencyTrustedContainer",bodyState:"emergencyTrusted",scrollParent:T,persistent:!1,searchPlaceholder:Strings.translateString("search people I trust"),buildOptions:{allowDrag:!1},title:Strings.translateString("People I Trust"),addMenu:[P.EmergencyAccess]}),fe=new re({containerType:EmergencyAccessSharerContainer,dataFunction:function(e,t){this.makeDataRequest(LPProxy.getEmergencyAccessSharerInfo,{success:e})},filter:{showEmptyGroups:!1},notificationCount:function(){var e=0,t=bg.get("g_emer_sharers");if(t)for(var n=0,o=t.length;n<o;++n)"0"===t[n].accepted&&++e;return e},sortOptions:e,menuElement:$("#emergencyTrustingMenuItem"),contentID:"emergencyTrusting",bodyState:"emergencyTrusting",scrollParent:T,persistent:!1,searchPlaceholder:Strings.translateString("search people who trust me"),buildOptions:{allowDrag:!1},title:Strings.translateString("People Who Trust Me")}),he=new le({menuElement:$("#emergencyAccessMenuItem"),defaultView:function(){return 0<fe.notificationCount()?fe:me},views:[me,fe]}),ye=new ae({bodyState:"reactMainView",menuElement:$(".securityDashboardMenuItem"),persistent:!1,contentID:"securityDashboard",scrollParent:T,filter:{multiSelect:!1,showEmptyGroups:!1},buildOptions:{allowDrag:!1,multiSelect:!1,stickyFolders:!1},title:Strings.translateString("Security Dashboard")});ye.show=function(){ae.prototype.show.call(this),reduxApp.navigate("/vault/security")},ye.hide=function(){ae.prototype.hide.call(this),reduxApp.navigate("/vault")};var ve=new re({containerType:IndividualShareContainer,sortOptions:f,menuElement:$("#receivedSharesMenuItem"),contentID:"receivedSharesContent",bodyState:"receivedShares",scrollParent:T,persistent:!1,notificationCount:function(){return bg.get("g_pendings").length},searchPlaceholder:Strings.translateString("search my received shares"),buildOptions:{multiSelect:!1},filter:{showEmptyGroups:!1,multiSelect:!1},title:Strings.translateString("Shared with Me"),addMenu:[P.ShareItems],dataFunction:(Pe=function(e){for(var t=LPProxy.getAllModelItems(),n=[],o=0,i=t.length;o<i;++o){var a=t[o],r=e[a.getID()];r&&"1"===r.state&&a instanceof AccountBase&&n.push(new AcceptedReceivedSharedItem(a,r))}return n},Le=function(e){for(var t=LPProxy.getPendingRecievedShares(),n=!1,o=0,i=t.length;o<i;++o){var a=t[o],r=e[a._model.getID()];r?a._model._shareData=r:n=!0}return n&&LPProxy.refreshSites(),t},be=function(e,t,n){var o=Pe(e),i=Le(e);t(o.concat(i))},function(t,n){this.makeDataRequest(LPProxy.getReceivedShareData,{params:{url:document.location.href},success:function(e){be(e,t,n)}})})}),Pe,Le,be,Se=new re({containerType:IndividualShareContainer,sortOptions:m,menuElement:$("#sentSharesMenuItem"),contentID:"sentSharesContent",bodyState:"sentShares",scrollParent:T,persistent:!1,searchPlaceholder:Strings.translateString("search my sent shares"),buildOptions:{multiSelect:!1},filter:{showEmptyGroups:!1,multiSelect:!1},title:Strings.translateString("Shared with Others"),addMenu:[P.ShareItems],dataFunction:(Ee=function(e,t,n){for(var o=LPProxy.getAllModelItems(),i=[],a=0,r=o.length;a<r;++a){var s=o[a];i=i.concat(LPTools.buildSentShareItems(s,e[s.getID()]))}t(i,n)},function(t,n){this.makeDataRequest(LPProxy.getSentShareData,{params:{},success:function(e){Ee(e,t,n)}})})}),Ee,Ie=new re({containerType:SharedFolderContainer,dataFunction:(Te=function(e,t,n){for(var o=LPProxy.getAllSharedGroupModelsByID(),i=[],a=0,r=e.length;a<r;++a){var s=e[a];if(s.sharedata){var l=o[s.shareid];i.push(new SharedFolderItem(l,s))}}t(i)},function(t,n){this.makeDataRequest(LPProxy.getSharedFolderData,{params:{},success:function(e){Te(e,t,n)}})}),notificationCount:function(){return bg.get("g_pending_shares").length},sortOptions:h,menuElement:$("#sharedFoldersMenuItem"),contentID:"sharedFoldersContent",bodyState:"sharedFolders",scrollParent:T,searchPlaceholder:Strings.translateString("search my shared folders"),buildOptions:{multiSelect:!1},title:Strings.translateString("Shared Folders"),addMenu:[P.SharedFolder],additionalOptionButtons:[(_e=$(LPTools.buildCheckbox(null,{text:Strings.translateString("View Deleted Shared Folders")})),_e.attr("id","showDeletedSharedFoldersButton"),_e.addClass("optionButtons"),_e.bind("click",function(){Lt()}),_e)]}),_e,Te;Ie.initialize=function(e,t){var n,o;n=this,e=(o=e)?function(){Pt({checkForStateChange:!1}),o()}:function(){Pt({checkForStateChange:!1})},re.prototype.initialize.call(this,e,t)};var Ce=new le({menuElement:$(".sharingMenuItem"),defaultView:function(){return 0<ve.notificationCount()?ve:LPProxy.getAccountClass()===Constants.USER_FREE||LPProxy.getAccountClass()===Constants.USER_PREMIUM&&LPProxy.isPremiumAsAPerk()&&!LPProxy.isLegacyPremium()?Se:LPFeatures.allowSharedFolders()?Ie:ve},views:[Ie,Se,ve]}),Ae=new ae({menuElement:$("#newSettingsMenuItem"),bodyState:"newSettings",title:Strings.translateString("Settings"),addMenu:null,scrollParent:$(document.body)}),De=function(){LPTools.hideContextMenu(ne),ne=null},we=function(e){e.preventDefault(),e.stopPropagation()},Me=function(){Y.val("")},Fe=function(){De(),ft(),Ne(),Ue()},ke=function(){oe&&oe.clearSelected()},xe=function(){Me(),ke()},Oe=function(t){return function(e){De(),oe.setSortOrder(t),s.sort(t),we(e)}},Be=function(e){if(null!==e){LPTools.removeDOMChildren(W);for(var t=0,n=e.length;t<n;++t){var o=a.createElement("li"),i=e[t];o.textContent=i,LPPlatform.addEventListener(o,"click",Oe(i)),W.appendChild(o)}O.show()}else O.hide()},Re=function(e){if(0<e){var t=Strings.translateString("%d items selected",e);$("#selectedItemCounter").text(t)}},Ne=function(){H.removeClass("selected"),I.hide("fast"),S.hide()},$e=function(){C.addClass("open")},Ue=function(){C.removeClass("open")},Ge=function(e,t){var n=LPProxy.getAllItems({identity:e}),o=new GridListContainer(n,{separateItems:!0,separateFavorites:!0,stickyFolders:!0,ignoreFilterOnSearch:!0,keyboardNavigation:!0,stickyFolderParent:a.getElementById("main"),folderStateChange:tt});for(var i in et(o),ut(o,Tt.all.getSortOrder()),o.initialize(a.getElementById("vaultContent"),T),o.applyFilter(t),Ct(o),Tt)Tt[i].setContainer(o);return o},ze=void 0===bg.get_method?"undefined":bg.get_method();s.initializeWelcomeDialogs=function(){bg.MigrationBackground.getShouldStartMigration(function(e){e?(bg.MigrationBackground.setShouldStartMigration(!1),He()):bg.MigrationBackground.shouldShowMigrationNotification()?s.openVaultTakeOverUpdateNotification():LPFeatures.safari_legacy_messaging()?dialogs.vaultInfoBanner.open({title:Strings.translateString("Safari extension update required"),contentText1:Strings.translateString("Due to new Apple requirements, you need to download the new LastPass app to continue using LastPass in your Safari browser."),contentText2:Strings.translateString("After download, simply login to your account again and use LastPass in Safari as you always have."),buttons:[{style:"btn-blue",sizeStyle:"col-2 btn-container-lg",autoId:"updateBtn",text:Strings.translateString("Update"),closeOnClick:!0,action:function(){bg&&bg.openURL&&bg.openURL("https://lastpass.com/safariAppExtension.php?source=vault")}},{style:"btn-link",sizeStyle:"col-1 btn-container-sm",autoId:"closeBtn",text:Strings.translateString("Close"),closeOnClick:!0}]}):"undefined"===ze&&!s.isExtensionDownloaded()&&LPFeatures.allowLicenseExpiration()&&(VaultLicenseExpiration.premiumTrialStatusChecker()||VaultLicenseExpiration.companyLicenseStatusChecker())?VaultLicenseExpiration.showExpirationMessage():"undefined"!==ze||s.isExtensionDownloaded()||!LPFeatures.isDownloadExtensionWebPromptEnabled()||bg.get("g_hasplugin")?LPPlatform.showIntroTutorial():dialogs.vaultInfoBanner.open({title:Strings.translateString("Donâ€™t miss out the best LastPass features. Install LastPass extension to avoid limitations."),dialogClass:"migrationBanner",hideXCloseBtn:!0,segmentEvents:{show:{name:"download_extension_prompt_shown"},download:{name:"download_extension_prompt_clicked",properties:{action:"download"}},learn:{name:"download_extension_prompt_clicked",properties:{action:"learn"}},close:{name:"download_extension_prompt_clicked",properties:{action:"close"}}},buttons:[{style:"btn-link",sizeStyle:"col-2 btn-container-sm pull-right",text:Strings.translateString("Learn More"),action:function(){bg.openURL("https://support.logmeininc.com/lastpass/help/what-is-the-difference-between-my-local-online-and-offline-vaults-lp010104")},segment:"learn"},{style:"btn-gray",sizeStyle:"col-2 btn-container-lg pull-right",autoId:"downloadNowBtn",text:Strings.translateString("Install Now"),action:function(){"object"==typeof top.LP_ExtInstall&&"function"==typeof top.LP_ExtInstall.run?top.LP_ExtInstall.run():bg&&bg.openURL&&bg.openURL("https://lastpass.com/misc_download2.php")},segment:"download"}]})})},s.showFormFillMigrationMessage=function(){var e="Please finish the latest update to access your Form Fills information";dialogs.vaultInfoBanner.open({title:Strings.translateString(e),dialogClass:"migrationBanner",segmentEvents:{show:{name:"migration_formfill_notification_shown",properties:{version:"vault",vault_version:"omar"}},update:{name:"migration_formfill_notification_clicked",properties:{action:"update_now",version:"vault",vault_version:"omar"}}},buttons:[{style:"btn-link",sizeStyle:"col-1 btn-container-sm",text:Strings.translateString("Learn More"),action:function(){bg.openURL("https://link.lastpass.com/help-new-form-fills")},segment:"learn"},{style:"btn-gray",sizeStyle:"col-2 btn-container-lg",text:Strings.translateString("Finish the Update"),action:function(){s.startFormFillMigration(ze)},segment:"update"}],hideXCloseBtn:!0})},s.initializeCategoryBackground=function(){if(bg.MigrationBackground.shouldShowMigrationNotification()){document.getElementsByTagName("body")[0].classList.add("vaultCategoryTakeoverOverride");for(var e=[document.getElementById("addressesButton"),document.getElementById("paymentCardsButton"),document.getElementById("bankAccountsButton")],t=["vault_addresses","vault_payment_cards","vault_bank_accounts"],n=0;n<e.length;n++){var o=t[n];e[n].addEventListener("click",function(){bg.sendLpImprove("migration_formfill_notification_clicked",{action:"migrate",version:"vault_takeover",vault_version:"omar",source:o}),s.startFormFillMigration(ze)})}for(var i=[document.getElementById("addresses"),document.getElementById("payment-cards"),document.getElementById("bank-accounts")],a=0;a<i.length;a++){var r=t[a];i[a].addEventListener("click",function(){bg.sendLpImprove("migration_formfill_notification_shown",{version:"vault_takeover",vault_version:"omar",source:r})})}document.getElementById("emptyAddressesWrapper").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapper").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapper").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyAddressesWrapperMigration").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapperMigration").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapperMigration").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("addMenuArrow").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("mainScroll").style.height="720px"}else document.getElementById("emptyAddressesWrapper").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapper").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapper").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyAddressesWrapperMigration").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapperMigration").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapperMigration").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("addMenuArrow").classList.remove("vaultCategoryTakeoverContainerHidden")},s.showWelcomeUpdateDialog=function(e){var t="Update to the new LastPass experience. It should only take a minute. You'll be logged out here and taken to LastPass.com to finish. Sorry for the inconvenience, but it only happens once - and it's worth it! Promise.";"cr"!==e&&"ff"!==e&&"undefined"!==e&&"edgecr"!==e||(t="Update to the new LastPass experience. It should only take a minute."),s.showFormFillMigrationMessage()},s.isExtensionDownloaded=function(){return null!==top.ext},s.initialize=function(e){try{if(bg.sendLpImprove("user_vault_opened"),a.body.removeAttribute("class"),Topics.get(Topics.REFRESH_DATA).publish(),$(".leftMenuItem").removeClass("selected"),LPProxy.getPreference("gridView")||s.displayAsList(),LPProxy.getPreference("compactView")&&s.displayCompact(),this.firstTimeLogin(),U.attr("title","Maximize Menu"),LPFeatures.allowGift()){var t=$("#specialOfferMenu");t.show(),t.bind("click",function(){bg.sendLpImprove("lpgift_ad_clicked"),bg.openURL(LPProxy.getBaseURL()+"gift.php")})}if(VaultLicenseExpiration.initialize(),je(),Ve(),We(),LPFeatures.allowTryFamilies()&&$("#lp-try-families").show(),"undefined"!=typeof bg){var n=LPProxy.getAccountClass();n!==Constants.USER_FREE&&n!==Constants.USER_PREMIUM_TRIAL||Ye()}}catch(e){LPPlatform.logException(e)}finally{var o=$("#vaultLoadingOverlay");LPTools.getOption(e,"fadeIn",!1)?(o.addClass("fadeIn"),setTimeout(function(){o.addClass("loaded")},500)):o.addClass("loaded"),V.addClass("loaded")}};var Ve=function(){bg.LPPartner&&bg.LPPartner.getPartnerInfo&&bg.LPPartner.getPartnerInfo(function(e){e?($("#logoPartner").attr("src",e.logoWhiteUrl).addClass(e.classWhite),$("#logoPartnerContainer").addClass("show")):$("#logoPartnerContainer").removeClass("show")})},He=function(e){$("#inProgressMigration").show(),bg&&bg.clear_badge&&bg.clear_badge();var n=$("#inProgressMigration").find(".progress-bar");Migrator.executeMigrations(function(e,t){n.css("width",Math.floor(e/t*100)+"%")},!!e)},We=function(){$("#vaultFooter").addClass("disabled")},Ye=function(){$("#upgradeButton").addClass("headerButtonActive").click(function(){bg.sendLpImprove("upgrade_button_vault_click"),LPPlatform.purchasePremium()})},je=(qe=function(t){s.openReceivedShareCenter(function(){var e=LPProxy.getPendingRecievedShare(t);e&&s.openAcceptShareDialog(e)})},Xe=function(t){s.openReceivedShareCenter(function(){var e=LPProxy.getPendingRecievedShare(t);e&&e.reject()})},Ke=function(e){LPProxy.getSiteModel(e)?s.openSiteDialog({vaultItem:e}):LPProxy.getNoteModel(e)?s.openNoteDialog({vaultItem:e}):LPProxy.getFormFillModel(e)&&s.openFormFillDialog({vaultItem:e})},Qe=function(e){switch(e){case"emergencyAccess":me.show();break;case"emergencyAccessOthers":fe.show();break;default:Tt.all.show()}},Ze=function(){s.openManageIdentities(),s.openIdentityDialog()},Je=function(e){for(var t=[],n=0,o=(e=e.split(",")).length;n<o;++n){var i=e[n],a=LPProxy.getSiteModel(i);(a=a||LPProxy.getNoteModel(i))&&t.push(a)}0<t.length&&s.openShareDialog(t)},function(){var e=LPTools.getURLParams();for(var t in LPPlatform.setIntroTutorialDisable(!1),e){var n=e[t];switch("cmd"===t&&(t=n),t){case"opengoogleauth":case"opensettings":Topics.get(Topics.EDIT_SETTINGS).publish();break;case"openhistory":LPProxy.openHistory();break;case"openbookmarklets":LPProxy.openBookmarklets();break;case"linkpersonal":s.openLinkAccountDialog();break;case"unlinkpersonal":s.unlinkAccount();break;case"sharedfolder":case"sf":s.openSharingCenter();break;case"sfadd":s.openSharingCenter(),s.openCreateSharedFolderDialog();break;case"sfadduser":if(s.openSharingCenter(),!e.shareid)break;var o=LPProxy.getAllSharedGroupModelsByID()[e.shareid];o&&Topics.get(Topics.EDIT_SHARED_FOLDER).publish(o);break;case"sfaddsite":if(s.openSharingCenter(),!e.shareid)break;(o=LPProxy.getAllSharedGroupModelsByID()[e.shareid])&&o._shareInfo.name&&s.openSiteDialog({saveOptions:{source:"vault"},defaultData:{group:"Shared-"+o._shareInfo.name}});break;case"addidentity":Ze();break;case"showdeleted":s.openDeletedItems();break;case"viewcreditmon":s.openCreditMonitoring();break;case"share":Je(n);break;case"ffid":case"edit":Ke(n);break;case"acceptshare":qe(n);break;case"rejectshare":Xe(n);break;case"omsstart":LPPlatform.setIntroTutorialDisable(!0)}}null===oe&&Qe(e.view)}),qe,Xe,Ke,Qe,Ze,Je,et=function(e){var t=LPPlatform.getOpenGroups();if(null!==t){for(var n=!0,o=e.getAllSubGroupsIncludingFavorites(!0),i=0,a=o.length;i<a;++i){var r=o[i];t[r._model.getName()]?(r.expand(),n=!1):r.collapse()}n&&Topics.get(Topics.ALL_COLLAPSED).publish()}},tt=function(e){if(e){for(var t=e.getAllSubGroupsIncludingFavorites(!0),n=[],o=0,i=t.length;o<i;++o){var a=t[o];a.isExpanded()&&n.push(a._model.getName())}LPPlatform.setOpenGroups(n)}},nt=function(e,t,n){var o=a.getElementById("sharedFoldersMenuItem").parentElement;e===Constants.USER_FREE?($("#emptySharedFoldersIcon .tourText").append(LPTools.createElement("a",{class:"nbtn rbtn dynamicWidth",href:LPProxy.getBaseURL()+"go-premium",target:"_blank"},Strings.translateString("Upgrade to Premium"))),o.parentElement.appendChild(o)):e===Constants.USER_PREMIUM&&t&&!n&&a.getElementById("sharedFoldersMenuItem").remove(),$(o.parentElement).children().last().addClass("last")},ot=function(e){var t=$(".securityScore");t.text(null!==e?Math.round(e)+"%":""),void 0!==e?t.parents(".menuIcon").addClass("score"):t.parents(".menuIcon").removeClass("score")};s.toggleInProgressOverlay=function(){E.toggle()};var it=function(e,t){0<t?(e.text(t),e.show()):e.hide()},at=(rt=!1,function(){if(!rt)for(var e=LPProxy.getEmergencyAccessRecipientModels(),t=0,n=e.length;t<n;++t){var o=e[t];if(o.allowedAccess()||o.hasRequestedAccess()){dialogs.denyEmergencyAccess.open({sharee:o}),rt=!0;break}}}),rt;s.openVault=function(){Tt.all.show()},s.openNotes=function(){Tt.notes.show()},s.openFormFills=function(){Tt.formFill.show()},s.toggleAdvancedMenu=function(e){H.toggleClass("selected"),I.toggle("fast"),S.toggle(),we(e)},s.clear=function(){b&&(b.destruct(),b=null),$(a.body).addClass("loggedout"),LPPlatform.shouldShowVaultLoginButton()&&$(a.body).addClass(LPPlatform.canBackgroundOpenPopover()?"canopenpopover":"cannotopenpopover"),$("#vaultLoadingOverlay").removeClass("loaded fadeIn"),xe(),ne=te=J=Z=oe=null},s.maximizeLeftMenu=function(){V.addClass("maximized"),U.addClass("opened"),U.attr("title",Strings.translateString("Minimize")),setTimeout(Topics.get(Topics.VAULT_LEFT_MENU_TOGGLE).publish,400)},s.minimizeLeftMenu=function(){V.removeClass("maximized"),U.removeClass("opened"),U.attr("title",Strings.translateString("Maximize")),setTimeout(Topics.get(Topics.VAULT_LEFT_MENU_TOGGLE).publish,400)},s.toggleLeftMenu=function(){var e=!V.hasClass("maximized");LPProxy.setPreferences("leftMenuMaximize",e),e?s.maximizeLeftMenu():s.minimizeLeftMenu()},s.addSource=function(e){return e?e.saveOptions&&e.saveOptions.source||(e.saveOptions={source:"vault"}):e={saveOptions:{source:"vault"}},e},s.openSiteDialog=function(e){dialogs.site.open(s.addSource(e))},s.openNoteDialog=function(e){dialogs.note.open(s.addSource(e))},s.openFormFillDialog=function(e){dialogs.formFill.open(s.addSource(e))},s.openFolderDialog=function(e,t){dialogs.folder.open({vaultItem:e,defaultData:{groupParent:t?t.getName():""},groups:te.getAllSubGroups()})},s.openTryFamiliesDialog=function(e,t){e=e||!1;var n=t?{origin:t}:{};bg.sendLpImprove("try_families_lightbox_shown",n),dialogs.tryFamilies.open({forceAccepted:e})},s.openUpgradeFamiliesForFolderSharingDialog=function(e){var t={forceAccepted:e||!1};bg.sendLpImprove("shared_folder_families_lightbox_shown"),dialogs.upgradeFamiliesForFolderSharing.open(t)},s.openFamiliesInvitationDialog=function(t){LPProxy.getFamiliesInvitations({params:{},success:function(e){0<e.length?(e.sort(function(e,t){return new Date(t.date)-new Date(e.date)}),dialogs.familiesInvitation.open({invitations:e,callback:t})):t(!1)},error:function(){t(!1)}})};var st=function(){var e=LPProxy.getAccountClass();return e===Constants.USER_FREE||e===Constants.USER_PREMIUM_TRIAL||e===Constants.USER_PREMIUM},lt=function(){var e=bg.localStorage_getItem("lp_families_dialog_snooze_timestamp"),t=bg.localStorage_getItem("lp_families_dialog_snooze_count"),n,o;return e&&parseInt(e)>Date.now()&&(t&&"1"===t)},ct=function(){var e=bg.localStorage_getItem("lp_try_families_dialog_declined"),t=bg.localStorage_getItem("lp_families_dialog_snooze_count"),n=t&&1<parseInt(t);return e||n},dt;s.openCreateSharedFolderDialog=function(e,t){!LPProxy.isLegacyPremium()&&st()&&LPFeatures.allowTryFamilies()&&!LPProxy.isFamiliesTrialStarted()?s.openUpgradeFamiliesForFolderSharingDialog(!1):LPProxy.isFamilyUser()&&bg.get("LPContentScriptFeatures").family_shared_folders_enabled?dialogs.familiesSharedFolder.open({group:e,children:t}):LPProxy.getAccountClass()===Constants.USER_FREE?(bg.sendLpImprove("upgrade_to_premium_lightbox_shown"),dialogs.upgradePremium.open({upgradeText:[LPTools.createElement("h1","upgradeDialogHeader",Strings.translateString("Need to share passwords with family or friends?")),LPTools.createElement("p","dialogText",Strings.translateString("Go Premium now to create a Shared Folder, invite family or friends, and fill the folder with passwords and notes. Give up to 5 people access to the Shared Folder. Changes are synced automatically, and you can assign read-only access. Go Premium now to create a Shared Folder!"))]})):dialogs.createSharedFolder.open({group:e,children:t})},s.openSettingsDialog=function(){null===Z&&(AccountSettingsService.call(function(e){Z=e,s.openSettingsDialog()},function(){Notifications.displayErrorMessage("Could not retrieve account settings!")}),Topics.get(Topics.DIALOG_LOADING).publish()),dialogs.settings.open(Z)},s.openLinkAccountDialog=function(){LPProxy.callAcctsIFrameCommand("linkpersonal")},s.openVerifyLinkedAccountDialog=function(){LPProxy.callAcctsIFrameCommand("verifypersonal")},s.unlinkAccount=function(){var e=LPProxy.getLinkedAccount();e&&e.unlink()},s.toggleCollapseAll=(dt=!1,Topics.get(Topics.ALL_COLLAPSED).subscribe(function(){dt=!0,k.addClass("selected"),k.attr("title",Strings.Vault.EXPAND_ALL)}),Topics.get(Topics.ALL_EXPANDED).subscribe(function(){dt=!1,k.removeClass("selected"),k.attr("title",Strings.Vault.COLLAPSE_ALL)}),function(){dt?(Topics.get(Topics.EXPAND_ALL).publish(),Topics.get(Topics.ALL_EXPANDED).publish()):(Topics.get(Topics.COLLAPSE_ALL).publish(),Topics.get(Topics.ALL_COLLAPSED).publish())}),s.toggleSize=(s.displayLarge=function(){Topics.get(Topics.DISPLAY_LARGE).publish(),x.removeClass("selected"),x.attr("title",Strings.Vault.COMPACT_VIEW)},s.displayCompact=function(){Topics.get(Topics.DISPLAY_COMPACT).publish(),x.addClass("selected"),x.attr("title",Strings.Vault.LARGE_VIEW)},function(){LPProxy.getPreference("compactView")?(s.displayCompact(),bg.lpevent(ee?"v_grd_cmp":"v_lst_cmp")):(s.displayLarge(),bg.lpevent(ee?"v_grd_lrg":"v_lst_lrg"))}),s.displayAsGrid=function(){Topics.get(Topics.DISPLAY_GRID).publish(),M.addClass("selected"),F.removeClass("selected"),ee=!0},s.displayAsList=function(){Topics.get(Topics.DISPLAY_LIST).publish(),F.addClass("selected"),M.removeClass("selected"),ee=!1},s.search=function(e){oe&&oe.search(e)};var ut=function(e,t){switch(t){case r:e.sortByName(!0);break;case l:e.sortByName(!1);break;case n:e.sortByFolder(!0);break;case o:e.sortByFolder(!1);break;case c:e.sortItemsByMostRecent();break;case d:case p:e.sortByEmail(!0);break;case u:case g:e.sortByEmail(!1)}};s.sort=function(e){R.text(e),ut(oe.getContainer(),e)};var pt=function(e){B.toggle("fast"),ne=B,LPTools.addKeyBoardNavigation(W.children),we(e)},gt=function(e){if(null===ne||ne.get(0).parentElement!==z){var t=oe.createSelectionContextMenu();z.appendChild(t),t.removeAttribute("style"),(ne=$(t)).show("fast")}else De();we(e)};s.showMoreOptionsMenu=function(){G.show("fast")},s.hideMoreOptionsMenu=function(){G.hide("fast")};var mt=function(e){j.toggleClass("selected"),N.toggle("fast"),we(e)},ft=function(){N.hide("fast"),j.removeClass("selected")};s.openEmergencyAccess=function(){he.show()},s.openEmergencyAccessTrusted=function(){he.show(me)},s.openEmergencyAccessTrusting=function(){he.show(fe)},s.openRestrictedEmergencyAccess=function(){dialogs.restrictedEmergencyAccess.open()},s.openVaultTakeOverUpdateNotification=function(){dialogs.vaultTakeoverUpdateNotification.open()},s.startFormFillMigration=function(e){"cr"===e||"ff"===e||"undefined"===e||"edgecr"===e?(bg.MigrationBackground.setShouldStartMigration(!1),He()):(bg.openURL("https://lastpass.com/experience-update"),bg.lpevent("m_lo"),bg.loggedOut(!1,"menu"))},s.openSecurityDashboard=function(){ye.show()},s.openSharingCenter=function(e){Ce.show()},s.openReceivedShareCenter=function(e){Ce.show(ve,e)},s.openSentShareCenter=function(e){Ce.show(Se,e)};var ht=!(s.openSharedFolderCenter=function(e){Ce.show(Ie,e)}),yt=function(e){Ie.getContainer().applyFilter({showEmptyGroups:!1,multiSelect:!1,func:function(e){return!e._model.isDeleted()}},e),ht=!1},vt=function(e){Ie.getContainer().applyFilter({showEmptyGroups:!1,multiSelect:!1,func:function(e){return!0}},e),ht=!0},Pt=function(e){ht?vt(e):yt(e)},Lt=function(){ht?yt():vt()},bt;if(s.openAcceptShareDialog=function(e){dialogs.acceptShare.open({vaultItem:e,groups:te.getAllSubGroups()})},s.openShareDialog=function(e){LPTools.openShareDialog(e)},s.openSharedFolderDialog=function(e,t){LPProxy.isFamilyUser()&&e._shareInfo.cid!==Constants.UNAFFILIATED_COMPANY_ID&&bg.get("LPContentScriptFeatures").family_shared_folders_enabled?dialogs.familiesSharedFolder.open({folder:e,members:t}):dialogs.sharedFolder.open(e,t)},s.openSharedFolderAccessDialog=function(e){dialogs.sharedfolderAccess.open(e)},s.openRestrictedSharingDialog=function(){dialogs.restrictedSharing.open()},s.closeShareDialog=function(){dialogs.share.close(!0)},s.openManageIdentities=function(){ce.show()},s.openIdentityDialog=function(e){dialogs.identity.open(e)},s.enableIdentity=function(e){null!==J&&J!==e&&(J.disable(),LPProxy.enableIdentity(e)),J=e;var t=te?te._filter:null;null!==te&&(tt(te),te.destruct()),te=Ge(J,t)},s.openCreditMonitoring=function(e){de.show()},s.openCreateCreditMonitoringDialog=function(){dialogs.createCreditMonitoring.open()},s.openDeletedItems=function(e){pe.show()},s.convertFormFills=function(){bg.sendLpImprove("migration_button_clicked",{formfills:0<bg.get("g_formfills").length,blob_version:bg.get("LPContentScriptFeatures").blob_version_set}),He(!0)},s.showAdPane=function(){var e;if(void 0!==bg.is_edge?bg.is_edge():-1!==navigator.userAgent.indexOf(" Edge/"))return!1;var t=bg.get("g_prompts").improve?1:0,n=a.getElementById("ad"),o=a.createElement("iframe");o.setAttribute("src",i.getPartnerURL(LPProxy.getBaseURL()+"ads.php?nobr=1&noga=1&rand="+Math.floor(1e3*Math.random())+"&v="+LPProxy.getVersion())+"&g_lpImprove="+t),o.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups"),n.appendChild(o),V.addClass("freeUser"),setInterval(function(){o.setAttribute("src",i.getPartnerURL(LPProxy.getBaseURL()+"ads.php?v=4.0&nobr=1&noga=1&rand="+Math.floor(1e3*Math.random())+"&v="+LPProxy.getVersion())+"&g_lpImprove="+t)},3e5)},s.firstTimeLogin=function(){if(bg.get("g_first_time_login")){var e=LPTools.createElement("iframe",{class:"displaynone",src:LPProxy.getBaseURL()+"lppixel.php"});$("#main").after(e)}},V.bind("click",function(){Fe()}),$("#vault").bind("click",function(){ke(),Fe()}),$("#loginButton").bind("click",function(){bg.open_login()}),LPPlatform.addEventListener(window,"unload",function(){Topics.get(Topics.CLEAR_DATA).publish()}),Y.LP_addSearchHandlers("inputLight",function(e){s.search(e)}),Y.bind("keydown",function(e){var t;if(40===(e.keyCode||e.which)){var n=oe.getContainer();if(n){var o=n.getAllChildrenOrdered();0<o.length&&(o[0].focus(),e.preventDefault(),e.stopPropagation())}}}),$("#orderOption").bind("click",pt),$("#actions").bind("click",gt),$(".sharingMenuItem").bind("click",function(){var e;bg.sendLpImprove("sharing_center_vault_click"),!LPProxy.isLegacyPremium()&&st()&&LPFeatures.allowTryFamilies()&&!ct()&&!lt()&&LPProxy.isFamiliesTrialStarted()&&s.openTryFamiliesDialog(!1,"sharing_menu_item"),s.openSharingCenter()}),H.bind("click",s.toggleAdvancedMenu),S.bind("click",Ne),U.bind("click",s.toggleLeftMenu),LPPlatform.addEventListener(a.getElementById("settingsMenuItem"),"click",function(){Topics.get(Topics.EDIT_SETTINGS).publish({source:"sidebar"})}),$("#linkAccountMenuItem").bind("click",function(){s.openLinkAccountDialog()}),$("#verifyLinkedAccountMenuItem").bind("click",function(){s.openVerifyLinkedAccountDialog()}),I.on("click",".toolsMenuItem.subMenuOption",function(){return!1}),I.on("click",".toolsMenuItem",Ne),C.bind("mouseenter",$e),C.bind("mouseleave",Ue),C.bind("touchstart",function(e){C.unbind("mousenter"),C.unbind("mouseleave"),C.hasClass("open")||($e(),e.preventDefault())}),LPPlatform.addEventListener(a.getElementById("collapseAllToggle"),"click",function(){s.toggleCollapseAll()}),LPPlatform.addEventListener(a.getElementById("sizeToggle"),"click",function(){LPProxy.setPreferences("compactView",!LPProxy.getPreference("compactView")),s.toggleSize()}),LPPlatform.addEventListener(a.getElementById("gridButton"),"click",function(){s.displayAsGrid(),LPProxy.setPreferences("gridView",!0)}),LPPlatform.addEventListener(a.getElementById("listButton"),"click",function(){s.displayAsList(),LPProxy.setPreferences("gridView",!1)}),LPPlatform.addEventListener(a.getElementById("userMenuContainer"),"click",mt),LPPlatform.addEventListener(a.getElementById("manageIdentitiesMenuItem"),"click",function(){s.openManageIdentities()}),LPPlatform.addEventListener(a.getElementById("creditMonitoringMenuItem"),"click",function(){s.openCreditMonitoring()}),-1!=navigator.userAgent.indexOf(" Edge/")&&a.getElementById("creditMonitoringMenuItem").remove(),LPPlatform.addEventListener(a.getElementById("openTourMenuItem"),"click",function(){LPPlatform.openTour(!0)}),$(".toolsMenuItem.subMenuOption").bind("click",function(e){$(e.target.parentElement.nextElementSibling).toggle("fast"),$(e.target).toggleClass("selected"),we(e)}),LPPlatform.addEventListener(a.getElementById("toolsImport"),"click",function(){LPProxy.import()}),LPPlatform.addEventListener(a.getElementById("toolsExport"),"click",function(){LPProxy.export()}),LPPlatform.addEventListener(a.getElementById("toolsOpenFavorites"),"click",function(){LPProxy.openAllFavorites("vault")}),LPPlatform.addEventListener(a.getElementById("bookmarkletsMenuItem"),"click",function(){LPProxy.openBookmarklets()}),LPPlatform.addEventListener(a.getElementById("otpMenuItem"),"click",function(){$(this).attr("href",bg.get("base_url")+"otp.php")}),LPPlatform.addEventListener(a.getElementById("historyMenuItem"),"click",function(){LPProxy.openHistory()}),LPPlatform.addEventListener(a.getElementById("deletedMenuItem"),"click",function(){s.openDeletedItems()}),LPPlatform.addEventListener(a.getElementById("toolsMigrate"),"click",function(){s.convertFormFills()}),LPPlatform.addEventListener(a.getElementById("generateSharingKeys"),"click",function(){bg.lpevent("v_gsk"),dialogs.sharingKey.open()}),$("#generateSharingKeys").hide(),LPPlatform.addEventListener(a.getElementById("featureManager"),"click",function(){bg.openURL(window.location.origin+"/lastpass/index.html#/feature-manager")}),LPPlatform.addEventListener(a.getElementById("generatePasswordMenuItem"),"click",function(){var e;bg.lpevent("v_gpw"),(bg.get("LPContentScriptFeatures").better_generate_password_enabled?dialogs.betterGeneratePassword:dialogs.generatePassword).open({fillGenerated:!1,saveOptions:{source:"vault"}})}),$("#removedLinkedAccountMenuItem").bind("click",function(){s.unlinkAccount()}),$("#tryEnterprise").bind("click",function(){dialogs.enterpriseTrial.open()}),$("#emergencyAccessMenuItem").bind("click",function(){var e=0<bg.get("g_emer_sharers").length||0<bg.get("g_emer_sharees").length;!LPProxy.isFreeUser()&&!LPProxy.isExpiredFamilyUser()||e?(bg.sendLpImprove("emergency_access_vault_click"),s.openEmergencyAccess()):(bg.sendLpImprove("restricted_emergency_access_lightbox_shown"),s.openRestrictedEmergencyAccess())}),$(".securityMenuItem").bind("click",function(){bg.lpevent("v_sec"),bg.openseccheck()}),$("#adminConsoleMenuItem").bind("click",function(){bg.lpevent("v_oec"),bg.openentconsole()}),$("#more-options-refer-a-friend").bind("click",function(){bg.sendLpImprove("refer_a_friend_more_options_click")}),$("#more-options-go-premium").bind("click",function(){bg.sendLpImprove("go_premium_more_options_vault_click")}),$("#familyAdminConsoleMenuItem").bind("click",function(){bg.lpevent("v_ofc"),bg.openFamilyConsole(),bg.sendLpImprove("families_manage_families_click")}),$("#lp-try-families").bind("click",function(){st()&&LPFeatures.allowTryFamilies()&&s.openTryFamiliesDialog(!1,"try_families_submenu_item")}),Topics.get(Topics.ITEMS_DESELECTED).subscribe(function(){s.hideMoreOptionsMenu()}),Topics.get(Topics.ITEMS_SELECTED).subscribe(function(){s.showMoreOptionsMenu()}),Topics.get(Topics.SELECT_COUNT_CHANGE).subscribe(function(e){Re(e)}),Topics.get(Topics.CONTEXT_MENU).subscribe(function(e,t){t.parentElement!==a.body&&a.body.appendChild(t),ne=LPTools.displayContextMenu(e,t)}),Topics.get(Topics.CONTEXT_CLOSE).subscribe(function(){De()}),Topics.get(Topics.ITEM_SHARE).subscribe(function(e){s.openShareDialog(e)}),Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){s.enableIdentity(e),Ct(te)}),Topics.get(Topics.CLEAR_DATA).subscribe(function(){s.clear(),Dialog.prototype.closeAllDialogs(!0),bg.closeSettingsIframe()}),Topics.get(Topics.LOGIN).subscribe(function(e){Dt(),s.initialize(e),Dialog.prototype.closeAllDialogs(!0),s.initializeWelcomeDialogs(),s.initializeCategoryBackground()}),Topics.get(Topics.REQUEST_SUCCESS).subscribe(function(e){LPTools.getOption(e,"incrementAccountsVersion",!1)&&ke()}),bt=function(e,t,n){xe(),te.addChild(e.newDisplayObject(),t,n),Ct(te)},Topics.get(Topics.SITE_ADDED).subscribe(bt),Topics.get(Topics.NOTE_ADDED).subscribe(bt),Topics.get(Topics.FORM_FILL_ADDED).subscribe(bt),Topics.get(Topics.APPLICATION_ADDED).subscribe(bt),Topics.get(Topics.ITEM_REMOVED).subscribe(function(){Ct(te)}),Topics.get(Topics.EDIT_SHARED_FOLDER_ACCESS).subscribe(function(e){s.openSharedFolderAccessDialog(e)}),Topics.get(Topics.EDIT_SITE).subscribe(function(e){s.openSiteDialog(e)}),Topics.get(Topics.EDIT_NOTE).subscribe(function(e){s.openNoteDialog(e)}),Topics.get(Topics.EDIT_FORM_FILL).subscribe(function(e){s.openFormFillDialog(e)}),Topics.get(Topics.EDIT_APPLICATION).subscribe(function(e){dialogs.application.open(e)}),Topics.get(Topics.EDIT_SETTINGS).subscribe(function(e){bg.sendLpImprove("viewvaultsettings",{source:e&&e.source?e.source:""}),params={},bg.get("gRecovery")&&(params.recovery=bg.get("gRecovery")),e&&e.defaulttab&&(params.defaulttab=e.defaulttab),LPProxy.callAcctsIFrameCommand("settings",null,params)}),Topics.get(Topics.EDIT_IDENTITY).subscribe(function(e){s.openIdentityDialog(e)}),Topics.get(Topics.ACCEPT_SHARE).subscribe(function(e){s.openAcceptShareDialog(e)}),Topics.get(Topics.RENAME_FOLDER).subscribe(function(e){s.openFolderDialog(e)}),Topics.get(Topics.CREATE_SUB_FOLDER).subscribe(function(e){s.openFolderDialog(null,e)}),Topics.get(Topics.GROUP_ADDED).subscribe(function(e,t){if(xe(),te.addChild(e.newDisplayObject(),t),e instanceof SharedGroup){var n=Ie.getContainer();if(null!==n){var o=new SharedFolderItem(e);n.addChild(o)}}}),Topics.get(Topics.ESCAPE).subscribe(function(e){var t=Dialog.prototype.getCurrentDialog();t&&t.close(),ke(),Fe()}),Topics.get(Topics.EDIT_SHARED_FOLDER).subscribe(function(e,t){s.openSharedFolderDialog(e,t)}),Topics.get(Topics.IDENTITY_ADDED).subscribe(function(e){ce.getContainer().addChild(e.newDisplayObject())}),s.refreshVault=function(){LPProxy.initializeModel(),at(),(b=LPProxy.getUser()).initialize(N,$("#userMenuText")),LPTools.parseUserSpecificMenu(a.getElementById("tools"),b._accountClass),LPTools.parseUserSpecificMenu(a.getElementById("leftMenu"),b._accountClass),nt(LPProxy.getAccountClass(),LPProxy.isPremiumAsAPerk(),LPProxy.isLegacyPremium()),VaultState.setIdentities(b._identities),LPProxy.enableCurrentIdentity(b._identities),b.isFreeOrTrial()?s.showAdPane():V.removeClass("freeUser"),LPProxy.getSecurityChallengeScore(ot),Dialog.prototype.closeInProcessDialogs(),VaultItemDialog.prototype.refreshOpenDialogs(),Topics.get(Topics.REFRESH_PREFERENCES).publish(),De()},Topics.get(Topics.REFRESH_DATA).subscribe(s.refreshVault),Topics.get(Topics.UPDATE_NOTIFICATION_COUNT).subscribe(function(e){oe&&oe.updateNotificationCount("number"==typeof e?e:1)}),Topics.get(Topics.ACCOUNT_LINKED).subscribe(function(e){$("#linkAccountMenuItem").LP_hide(),$("#verifyLinkedAccountMenuItem").LP_hide(),$("#removedLinkedAccountMenuItem").LP_show()}),Topics.get(Topics.ACCOUNT_LINKED_NEEDS_VERIFICATION).subscribe(function(e){$("#linkAccountMenuItem").LP_hide(),$("#verifyLinkedAccountMenuItem").LP_show(),$("#removedLinkedAccountMenuItem").LP_hide()}),Topics.get(Topics.ACCOUNT_UNLINKED).subscribe(function(e){$("#linkAccountMenuItem").LP_show(),$("#verifyLinkedAccountMenuItem").LP_hide(),$("#removedLinkedAccountMenuItem").LP_hide()}),Topics.get(Topics.CREATE_SHARED_FOLDER).subscribe(function(e,t){s.openCreateSharedFolderDialog(e,t)}),Topics.get(Topics.REPROMPT).subscribe(function(e){dialogs.reprompt.open({successCallback:e})}),Topics.get(Topics.CONFIRM).subscribe(function(e){dialogs.confirmation.open(e)}),Topics.get(Topics.EMERGENCY_RECIPIENT_ADDED).subscribe(function(e){me.getContainer().addChild(e.newDisplayObject())}),Topics.get(Topics.EDIT_EMERGENCY_RECIPIENT).subscribe(function(e){dialogs.addEmergencyAccess.open({vaultItem:e})}),Topics.get(Topics.REAPPLY_SEARCH).subscribe(function(e,t){var n=Y.val();n&&e.applySearch(n,t)}),Topics.get(Topics.ENROLLED_CREDIT_MONITORING).subscribe(function(){de.refresh()}),Topics.get(Topics.ITEM_SHARED).subscribe(function(e){Se.refresh()}),Topics.get(Topics.REFRESH_PREFERENCES).subscribe(function(){switch(LPFeatures.updateFeatures({import:!0,noexport:!1,share:!0,share_onlyfolders:!1,show_notes:!0,bookmarklets:!0,hideidentities:!1,showcredmon:!0,link_personal:!0,show_formfills:!0}),LPProxy.hasReceivedShares()?V.removeClass("noReceivedShares"):V.addClass("noReceivedShares"),oe){case Se:LPFeatures.allowIndividualSharing()||(Ce.clear(),Tt.all.show(),dialogs.alert.open({title:Strings.translateString("Policy Update"),text:Strings.translateString("Your enterprise has prohibited individual sharing.")}));break;case Ie:LPFeatures.allowSharedFolders()||(Tt.all.show(),dialogs.alert.open({title:Strings.translateString("Policy Update"),text:Strings.translateString("Your enterprise has prohibited sharing.")}))}}),Strings.translate(a.body),$("input,textarea").prop("spellcheck",!1),LPFeatures.allowNewSettings()){var St=document.getElementById("new-settings-iframe");St.src=LPProxy.getBaseURL()+"newvault/lp-vault/settings.html",St.addEventListener("load",function(){St.contentWindow.postMessage({localkey:parent.g_local_key},LPProxy.getBaseURL())})}Topics.get(Topics.INTRO_TOURS_LOADED).subscribe(function(e){var t=LPProxy.seenVaultPostFamilies(),n=LPProxy.predatesFamilies(),o=LPFeatures.allowTryFamilies(),i=LPProxy.isFamiliesTrialStarted();!o||!n||t||ct()||lt()||!st()||i||s.openTryFamiliesDialog(!1,"first_vault_entry")}),Notifications.initialize();var Et=function(e,t,n){var o=LPTools.createElement("div",$.extend(n,{class:"leftMenuItem",id:n.id}));return o.appendChild(t),o.appendChild(LPTools.createElement("span",{class:"menuText"},e)),$(o)},It=function(e,t){return e instanceof GroupDisplay||e._model.getRecordType()===t.recordType},_t=function(t,e){if(t.types){var n=e.filter(function(e){return-1<t.types.indexOf(e.id)});return function(e){for(var t=0;t<n.length;++t)if(It(e,n[t]))return!0;return!1}}return function(e){return!(e instanceof FormFillDisplay)}},Tt={},Ct=function(l){if(LPFeatures.allowOmarIA()){var n=document.getElementById("leftMenuItemsContainer");LPTools.removeDOMChildren(n);var c=LPProxy.getRecordConfig(),d=!1,u=!1,p=function(e){d&&(n.appendChild(LPTools.createElement("div","leftMenuItemsDivider")),d=!1);var t=Tt[e.id].getElement();n.appendChild(t),null!=e.user&&t.setAttribute("user",e.user)},g=function(e,t){if(Array.isArray(e))d=0<t,e.forEach(g);else{var n=LPProxy.getConfigViewObject(e);if(n.default){if(n.types){var o=LPProxy.getConfigTypeObject(n.types[0]),i=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[],a;if(!(-1!==LPProxy.getAllModelTypes().indexOf(o.recordType))&&"Account"!==o.recordType&&(-1!==i.indexOf("0")||-1!==i.indexOf(o.enterprisePolicyId)))return}p(n)}else{var r=_t(n,c.types),s=l._filter;l.applyFilter({func:r},{checkForStateChange:!1}),0<l.getItemChildren().length?p(n):Tt[n.id]===oe&&(u=!0),l.applyFilter(s,{checkForStateChange:!1})}}};d=!0,c.viewConfig.forEach(g),LPTools.parseUserSpecificMenu(a.getElementById("leftMenu"),LPProxy.getAccountClass()),u&&Tt.all.show(),LPFeatures.hide_cloud_apps_policy_enabled()&&$("#cloud-apps").LP_hide(),LPFeatures.allowSecurityDashboard()?$(".securityMenuItem").LP_hide():$(".securityDashboardMenuItem").LP_hide(),Y.val()&&l.applySearch(Y.val(),{forceSearch:!0})}void 0===bg.get_method&&bg.get("LPContentScriptFeatures").omaria||$("#toolsMigrate").LP_hide()},At=function(e){var t,n=LPProxy.getRecordConfig();return t=e.types&&0<e.types.length?n.icons[e.types[0]]:n.icons.all,LPTools.createElement("i",{class:["menuIcon",t]})},Dt=function(){if(LPFeatures.allowOmarIA()){var i=LPProxy.getRecordConfig();i.views.forEach(function(o){Tt[o.id]=new se({filter:{showEmptyGroups:!0,func:_t(o,i.types)},sortOptions:e,menuElement:Et(Strings.translateString(o.name),At(o),{id:o.id}),bodyState:"vaultContent "+o.id,scrollParent:T,title:Strings.translateString(o.name),addMenu:[new v({text:"ADD_ITEM",autoId:"vaultAddItemButton",func:function(){var t,n=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[];o.types&&-1===n.indexOf("0")?i.types.forEach(function(e){if(e.id===o.types[0])switch(t=e.recordType){case i.TYPE.Password:dialogs.site.open();break;case i.TYPE.Custom:dialogs.addItem.open({isExpanded:!0});break;default:-1!==n.indexOf(e.enterprisePolicyId)?dialogs.addItem.open():dialogs.note.open({defaultData:{notetype:t,language:Note.prototype.isValidLanguage(navigator.language)?navigator.language:"en-US"}})}}):dialogs.addItem.open()}}),P.Folder]})})}else Tt.all=new se({filter:{showEmptyGroups:!0,func:function(e){return e instanceof AccountBaseDisplay||e instanceof ApplicationDisplay||e instanceof GroupDisplay}},sortOptions:e,menuElement:$("#vaultMenuItem"),bodyState:"vaultContent site",scrollParent:T,title:Strings.translateString("Sites"),addMenu:[P.Site,P.Note,P.ShareItems,P.Folder]}),Tt.notes=new se({filter:{showEmptyGroups:!1,func:function(e){return e instanceof NoteDisplay||e instanceof GroupDisplay}},sortOptions:e,menuElement:$("#notesMenuItem"),bodyState:"vaultContent note",scrollParent:T,title:Strings.translateString("Secure Notes"),addMenu:[P.Note,P.ShareItems,P.Folder]}),Tt.formFills=new se({filter:{showEmptyGroups:!1,multiSelect:!1,hasFolderView:!1,func:function(e){return e instanceof FormFillDisplay}},sortOptions:t,menuElement:$("#formFillMenuItem"),bodyState:"vaultContent formFill",scrollParent:T,title:Strings.translateString("Form Fills"),addMenu:[P.FormFill]});LPFeatures.isDogfood()||$("#featureManager").LP_hide(),LPFeatures.hide_cloud_apps_policy_enabled()?X.LP_hide():X.LP_show().bind("click",function(){bg.sendLpImprove("vault_cloud_apps_clicked"),bg.openOnNewTab("saml/launch/nopassword?RelayState=/")}),LPFeatures.hide_cloud_apps_policy_enabled()?$("#cloud-apps").LP_hide():$("#cloud-apps").LP_show().bind("click",function(){bg.sendLpImproveCallback("vault_cloud_apps_clicked",function(){window.location.href="/saml/launch/nopassword?RelayState=/"})}),LPFeatures.allowSecurityDashboard()?K.LP_hide():Q.LP_hide()}};Topics.get(Topics.INITIALIZED).subscribe(function(){if(initialize(document,LPVault,BuildVariables),LPPlatform.lpIsExtension()&&(bg.get("LPContentScriptFeatures").react_login||bg.get("LPContentScriptFeatures").security_dashboard)){var e=document.createElement("iframe");e.src="webclient-vault.html",$(e).LP_hide(),document.body.appendChild(e)}});
//# sourceMappingURL=sourcemaps/vault.js.map
